# GitHub Copilot Instructions - INAPA Event Attendance System

## üéØ **CONTEXTO DEL PROYECTO**

Este es un sistema de gesti√≥n de asistencia a eventos para el **Instituto Nacional de Aguas Potables y Alcantarillados (INAPA)** de Rep√∫blica Dominicana.

### **ARQUITECTURA T√âCNICA**
- **Frontend**: Next.js 15 (App Router) con TypeScript y Tailwind CSS
- **Backend**: Next.js API Routes con Prisma ORM
- **Base de Datos**: SQLite (desarrollo) / PostgreSQL (producci√≥n)
- **Integraci√≥n**: Google Calendar API para sincronizaci√≥n autom√°tica de eventos
- **UI**: shadcn/ui components con dise√±o profesional

## üöÄ **PRIORIDADES DE DESARROLLO (EN ORDEN)**

### **1. üîÑ SINCRONIZACI√ìN GOOGLE CALENDAR (M√ÅXIMA PRIORIDAD)**
- **NO crear eventos manualmente** - Todo debe venir de Google Calendar
- Completar `app/api/webhooks/google/calendar/route.ts` para procesar cambios reales
- Implementar `lib/google/calendar.ts` para sincronizaci√≥n bidireccional
- Manejar eventos creados, actualizados, cancelados desde Google Calendar
- Guardar eventos en base de datos local con estructura correcta

### **2. üì± FORMULARIO DE ASISTENCIA**
- Asegurar funcionamiento completo del formulario en `/app/eventos/[id]/page.tsx`
- Validaci√≥n de c√©dulas dominicanas (formato correcto)
- Registro de asistencias en base de datos
- Confirmaci√≥n inmediata al usuario

### **3. üë• VISTA ORGANIZADOR**
- Dashboard para ver eventos sincronizados desde Google Calendar
- Estad√≠sticas de asistencia por evento
- Lista de asistentes registrados
- **NO CRUD manual de eventos** - solo visualizaci√≥n

### **4. üìß NOTIFICACIONES (SECUNDARIO)**
- Sistema de emails b√°sico para confirmaciones
- Templates simples y profesionales

## üõ†Ô∏è **REGLAS DE DESARROLLO**

### **Eventos - SOLO DESDE GOOGLE CALENDAR**
- ‚úÖ **CORRECTO**: Todos los eventos deben originarse en Google Calendar
- ‚ùå **INCORRECTO**: No crear funcionalidad de creaci√≥n manual de eventos
- üîÑ **PROCESO**: Google Calendar ‚Üí Webhook ‚Üí Base de datos local

### **Flujo de Trabajo Principal**
1. **Organizador crea evento en Google Calendar** (fuera del sistema)
2. **Webhook recibe notificaci√≥n** de cambio en calendario
3. **Sistema sincroniza** evento a base de datos local
4. **Sistema genera link √∫nico** para formulario de asistencia
5. **Asistentes acceden** via link y completan datos
6. **Organizador ve estad√≠sticas** en dashboard

### **Esquema de Base de Datos - MODELO REQUERIDO**
**Tabla Event**: Debe incluir googleEventId √∫nico, datos de evento, organizador y asistentes
**Tabla Checkin**: Debe incluir datos completos del asistente, evento relacionado y timestamp
**Relaci√≥n**: Un evento puede tener m√∫ltiples checkins (asistencias registradas)

### **Validaci√≥n de C√©dulas Dominicanas**
**Requisito**: Implementar algoritmo est√°ndar de validaci√≥n de c√©dulas RD
**Criterios**: 11 d√≠gitos, d√≠gito verificador v√°lido, formato limpio sin guiones
**Validaci√≥n**: Debe rechazar c√©dulas inv√°lidas con mensaje claro al usuario

## üìÅ **ESTRUCTURA DE ARCHIVOS CR√çTICOS**

### **APIs Principales**
- `app/api/webhooks/google/calendar/route.ts` - Webhook para recibir cambios de Google Calendar
- `app/api/events/sync/route.ts` - Sincronizaci√≥n manual de eventos
- `app/api/attendance/route.ts` - Registro de asistencias
- `app/api/events/[id]/stats/route.ts` - Estad√≠sticas por evento

### **Componentes UI**
- `app/eventos/[id]/page.tsx` - Formulario de asistencia p√∫blico
- `app/dashboard/eventos/page.tsx` - Vista de organizador
- `components/forms/AttendanceForm.tsx` - Formulario de asistencia
- `components/events/EventStats.tsx` - Estad√≠sticas de evento

### **Librer√≠as de Negocio**
- `lib/google/calendar.ts` - Funciones de Google Calendar API
- `lib/validations/cedula.ts` - Validaci√≥n de c√©dulas dominicanas
- `lib/utils/attendance.ts` - L√≥gica de asistencias

## üö´ **QUE NO HACER**

1. **NO crear CRUD manual para eventos** - Solo sincronizaci√≥n desde Google Calendar
2. **NO implementar autenticaci√≥n compleja** inicialmente - enfoque en funcionalidad core
3. **NO templates de email complejos** - simple y funcional primero
4. **NO optimizaciones prematuras** - funcionalidad b√°sica primero

## ‚úÖ **CRITERIOS DE √âXITO**

### **Demo de 5 minutos debe mostrar:**
1. Evento creado en Google Calendar aparece autom√°ticamente en sistema
2. Link de asistencia funciona correctamente  
3. Formulario acepta datos v√°lidos y rechaza c√©dulas inv√°lidas
4. Dashboard muestra estad√≠sticas actualizadas
5. Todo funciona en m√≥vil y desktop

### **M√©tricas T√©cnicas**
- Sincronizaci√≥n Google Calendar: < 30 segundos
- Carga de formulario: < 3 segundos
- Validaci√≥n de c√©dula: instant√°nea
- Registro de asistencia: < 5 segundos

## üìù **CONVENCIONES DE C√ìDIGO**

### **Naming Conventions**
- Archivos: `kebab-case.tsx`
- Componentes: `PascalCase`
- Funciones: `camelCase`
- Variables: `camelCase`
- Constantes: `SCREAMING_SNAKE_CASE`

### **Error Handling**
**Est√°ndar**: Todos los endpoints deben manejar errores apropiadamente
**Logging**: Errores deben loguearse con contexto suficiente para debugging  
**Respuestas**: Retornar mensajes de error claros y √∫tiles al frontend

### **TypeScript - Ser Estricto**
**Interfaces**: Definir interfaces claras para todos los datos
**Validaci√≥n**: Validar par√°metros de entrada en todas las funciones
**Tipos**: Evitar el uso de 'any', usar tipos espec√≠ficos

## üéØ **ENFOQUE ACTUAL**

**FASE ACTUAL: Sincronizaci√≥n Google Calendar**
- Completar webhook de Google Calendar para procesar eventos reales
- Implementar l√≥gica de sincronizaci√≥n bidireccional
- Asegurar que eventos aparezcan correctamente en base de datos
- Probar con eventos reales de INAPA

**PR√ìXIMA FASE: Formulario de Asistencia**
- Validar funcionamiento completo del formulario
- Mejorar validaciones y UX
- Confirmar que registros se guardan correctamente

---

**√öltima actualizaci√≥n**: Agosto 26, 2025  
**Versi√≥n**: 2.0 - Enfoque Google Calendar  
**Estado**: üöß Desarrollo activo - Sincronizaci√≥n prioritaria
